<ui:component id="jsonp-maker"
              rendered="#{tableDef.feedId != null and not tableDef.feedId.isEmpty()}"
              xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
              xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:p="http://primefaces.org/ui"
              xmlns:aui="http://liferay.com/faces/aui"
              xmlns:fn="http://java.sun.com/jsp/jstl/functions"
              xmlns:portlet="http://java.sun.com/portlet_2_0">

  <span style="background-color:#111;opacity: 0.65;*background:none;position:absolute;z-index: 99;top:0px;left:0px;width:100%;"></span>

  <div class="ifeed-border rp-ifeed-popup">
    <div>
      <h:panelGrid columns="3" border="1" cellpadding="0" cellspacing="2" styleClass="rp-table">
        <f:facet name="header">
          <h:outputText value="Inställningar för listan"/>
        </f:facet>

        <h:outputText value="Antal rader"/>
        <h:selectOneMenu value="#{tableDef.limit}">
          <f:selectItem itemValue="0" itemLabel="Ingen begränsning"/>
          <f:selectItems value="#{fn:split('5,10,20,30,40,50,60,70,80,90,100,150,200', ',')}"/>
          <f:ajax render="ifeed_view"/>
        </h:selectOneMenu>
        <h:outputText value="Välj antal rader du vill begränsa listan till"/>

        <h:outputText value="Dölj EPI högerkolumn "/>
        <h:selectBooleanCheckbox value="#{tableDef.hideRightColumn}">
          <f:ajax event="change" render="ifeed_view"/>
        </h:selectBooleanCheckbox>
        <h:outputText value="Vill du dölja högerkolumnen i EPI-server för att få mer plats?"/>

        <h:outputText value="Välj sortering"/>
        <h:selectOneMenu style="text-align:left;" value="#{tableDef.defaultSortColumn}">
          <f:selectItems value="#{app.fieldInfsAsSelectItemGroups()}"/>
          <f:ajax event="change" render="ifeed_view"/>
        </h:selectOneMenu>
        <h:outputText value="Välj sorteringskolumn samt om sortering skall ske stigande eller fallande"/>

        <h:outputText value=""/>
        <h:selectOneMenu style="text-align:left;" value="#{tableDef.defaultSortColumn}">
          <f:selectItem itemLabel="Upp" itemValue="asc"/>
          <f:selectItem itemLabel="Ned" itemValue="desc"/>
          <f:ajax event="change" render="ifeed_view"/>
        </h:selectOneMenu>
        <h:outputText value=""/>

        <h:outputText value="Visa tabellhuvud"/>
        <h:selectBooleanCheckbox value="#{tableDef.showTableHeader}">
          <f:ajax event="change" render="ifeed_view"/>
        </h:selectBooleanCheckbox>
        <h:outputText value="Vill du visa tabellhuvudet (rubrikerna för kolumnerna)?"/>

        <h:outputText value="Teckenstorlek"/>
        <h:selectOneMenu value="#{tableDef.fontSize}">
          <f:selectItem itemValue="auto" itemLabel="Automatisk"/>
          <f:selectItems value="#{fn:split('10,11,12,13,14,15,16,17,18,19,20', ',')}"/>
          <f:ajax render="ifeed_view"/>
        </h:selectOneMenu>
        <h:outputText value="Välj teckenstorlek för listan"/>

        <h:outputText value="Länka till orginaldokument"/>
        <h:selectBooleanCheckbox value="#{tableDef.linkOriginalDoc}">
          <f:ajax event="change" render="ifeed_view"/>
        </h:selectBooleanCheckbox>
        <h:outputText value=""/>
      </h:panelGrid>
    </div>
    <br/>

    <div>
      <h:dataTable columns="5" border="1" cellpadding="0" cellspacing="2" styleClass="rp-table"
                   value="#{tableDef.columnDefs}" var="i">

        <f:facet name="header">
          <h:outputText value="Kolumner"/>
          <p:commandLink value="Lägg till" action="#{tableDef.createColumn()}"
                         ajax="true"
                         update=":ifeed_view"
                         immediate="true">
          </p:commandLink>
        </f:facet>

        <h:column>
          <f:facet name="header">
            <h:outputText value="Fält"/>
          </f:facet>
          <h:selectOneMenu style="text-align:left;" value="#{i.name}">
            <f:selectItems value="#{app.fieldInfsAsSelectItemGroups()}"/>
            <f:ajax event="change" render=":ifeed_view"/>
          </h:selectOneMenu>
        </h:column>

        <h:column>
          <f:facet name="header">
            <h:outputText value="Alias"/>
          </f:facet>
          <h:inputText value="#{i.label}">
            <f:ajax event="change" render=":ifeed_view"/>
          </h:inputText>
        </h:column>

        <h:column>
          <f:facet name="header">
            <h:outputText value="Justering"/>
          </f:facet>
          <h:selectOneMenu style="text-align:left;" value="#{i.alignment}">
            <f:selectItem itemValue="left" itemLabel=" Vänsterställd kolumn "/>
            <f:selectItem itemValue="right" itemLabel="Högerställd kolumn"/>
            <f:selectItem itemValue="center" itemLabel="Centrerad kolumn"/>
            <f:ajax event="change" render=":ifeed_view"/>
          </h:selectOneMenu>
        </h:column>

        <h:column>
          <f:facet name="header">
            <h:outputText value="Bredd"/>
          </f:facet>
          <h:inputText value="#{i.width}">
            <f:ajax event="change" render=":ifeed_view"/>
          </h:inputText>
        </h:column>

        <h:column>
          <f:facet name="header">
            <h:outputText value="Ta bort"/>
          </f:facet>
          <h:commandLink styleClass="ui-commandlink ui-widget link-button-trash" value=""
                         action="#{tableDef.columnDefs.remove(i)}"
                         immediate="true">
            <f:ajax render=":ifeed_view"/>
          </h:commandLink>
        </h:column>
      </h:dataTable>
    </div>
    <br/>

    <div>
      <h:panelGrid columns="1" border="1" cellpadding="0" cellspacing="2" styleClass="rp-table">
        <f:facet name="header">
          <h:outputText value="Kod att klistra in"/>
        </f:facet>
        <h:outputText value="#{tableDef.toTableMarkup()}" id="jsonp-result" styleClass="preformatted"/>
      </h:panelGrid>
    </div>
    <br/>

    <div>
      <p:commandButton value="Stäng"
                       actionListener="#{tableDef.setFeedId(null)}"
                       ajax="true"
                       update="ifeed_view"
                       immediate="true">
      </p:commandButton>
    </div>

  </div>
</ui:component>